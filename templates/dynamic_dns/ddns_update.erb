#!/bin/sh
##
## Generated by Chef for <%= @node[:fqdn] %>

TTL=3600
SERVER=ns1.zefironetworks.com
ZONE=zefironetworks.com
HOSTNAME=<%= @ddns_name %>
#maybe we can also use node[:fqdn]

KEYFILE="/etc/dyndns_keys/key.private"

nsupdate -v -k  $KEYFILE > /dev/null << EOF
server $SERVER
zone $ZONE
update delete $HOSTNAME A
update add $HOSTNAME $TTL A <%= @node[:ipaddress] %>
send
EOF
